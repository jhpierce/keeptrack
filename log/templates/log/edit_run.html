{% extends 'log/base.html' %}
{% load widget_tweaks %}

{% block content %}
<div class="container-fluid">
  <h2>Edit</h2>
  <div class="panel-group">
    <div class="panel panel-default">
      <div class="panel-heading">Edit</div>
        <div class="panel-body">
          {% if rep_formset %}
            <form method="post", name='intervalform' action="/log/athlete/edit_activity/{{ activity.id }}/">
                {% csrf_token %}

                {% if IntervalForm.errors %}
                    <div class="alert alert-error">
                        <ul>
                            {% for error in IntervalForm.non_field_errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                {% endif %}

                <div class="control-group date">
                  <label class="control-label">Date</label>
                  <div class="controls">
                    {{ IntervalForm.date|add_class:"form-control" }}
                  </div>
                </div>

                <div class="control-group date">
                  <label class="control-label">Warm Up</label>
                  <div class="controls">
                    {{ IntervalForm.warmup|add_class:"form-control" }}
                  </div>
                </div>

                <div class="control-group date">
                  <label class="control-label">Warm Up Units</label>
                  <div class="controls">
                    {{ IntervalForm.wu_units|add_class:"form-control" }}
                  </div>
                </div>

                <div>
                  {{ rep_formset.management_form }}
                  <label>Add Repeats</label>
                  {% for rep_form in rep_formset %}
                    <div class="link-formset">
                      <label>Distance</label>

                        {{ rep_form.rep_distance }}
                        {{ rep_form.rep_units }}

                      <label>Time (HMS)</label>
                        {{ rep_form.duration }}

                      <label>Rest (HMS)</label>
                        {{ rep_form.rep_rest }}

                    </div>
                  {% endfor %}
                </div>

                <div class="control-group date">
                  <label class="control-label">Cool Down</label>
                  <div class="controls">
                    {{ IntervalForm.cooldown|add_class:"form-control" }}
                  </div>
                </div>

                <div class="control-group date">
                  <label class="control-label">Cool Down Units</label>
                  <div class="controls">
                    {{ IntervalForm.cd_units|add_class:"form-control" }}
                  </div>
                </div>

                <div class="control-group date">
                  <label class="control-label">Description</label>
                  <div class="controls">
                    {{ IntervalForm.comments|add_class:"form-control" }}
                  </div>
                </div>

                <div class="control-group date">
                  <label class="control-label">User Label</label>
                  <div class="controls">
                    {{ IntervalForm.user_label|add_class:"form-control" }}
                  </div>
                </div>

                <input type="submit" value="Update Workout" class="btn btn-primary btn-large"/>
              </form>

            <!-- Include formset plugin - including jQuery dependency -->
            <script type="text/javascript" src="/static/log/js/dynamic_reps.js"></script>
            <script>
                $('.link-formset').formset({
                    addText: 'Add Repeat',
                    deleteText: 'Remove'
                });

            </script>
          {% else %}
            <form action="/log/athlete/edit_activity/{{ activity.id }}/" method="post" autocomplete="off">
              {% csrf_token %}
              {{ form.errors }}
              {{ form.non_field_errors }}
              {{ form.as_p }}
              <input type="submit" value="Update Run" />
            </form>
          {% endif %}
        {% endblock %}
      </div>
    </div>
  </div>
</div>
