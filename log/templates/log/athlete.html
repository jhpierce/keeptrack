{% extends 'log/base.html' %}
{% load staticfiles %}

{% block content %}
  <div>
    <div class="page_title" style="display:inline-block">
      <h2>{{ athlete_user.first_name }} {{ athlete_user.last_name}}</h2>
    </div>
    {% ifequal athlete_user.id user.id %}
      <div class='add_workout' style="display:inline-block">
        <a class='w_type btn' href="/log/athlete/add/NormalRun/">Add Normal Run</a>
        <a class='w_type btn' href="/log/athlete/add_intervals/">Add Interval Workout</a>
        <a class='w_type btn' href="/log/athlete/add/CrossTrain/">Add Cross Train</a>
        <a class='w_type btn' href="/log/athlete/add/Event/">Add Meet</a>
      </div>
      <a class= 'btn' href="/log/athlete/r2w_import/">Import Data from Running2Win</a>
    {% endifequal %}
  </div>
  <div id="page">

    <div class="module_container">
      <h3>Mileage</h3>
      <div id= "mileage_options">
        <div class="graph_option btn" id="current_year_selector">Year</div>
        <div class="graph_option btn" id="current_month_selector">Month</div>
        <div class="graph_option btn" id="current_week_selector">Week</div>
        <div class="graph_option btn" id="range_selector">Range</div>
      </div>

          <!--Load the AJAX API-->
          <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
          <!--Load the script with the actual mileage graph in it -->
          <script type="text/javascript">
            var year_graph_data = {{ year_graph_data|safe }}
          </script>
          <script type="text/javascript">
            var month_graph_data = {{ month_graph_data|safe }}
          </script>
          <script type="text/javascript">
            var week_graph_data = {{ week_graph_data|safe }}
          </script>
          {% if range_graph_data %}
            <script type="text/javascript">
              var range_graph_data = {{ range_graph_data|safe }}
            </script>
          {% endif %}
          <script type="text/javascript" src="{% static 'log/js/mileage.js' %}"></script>

          <!--Div that will hold the bar chart-->
        <div id="year_mileage_graph"></div>
        <div id="month_mileage_graph"></div>
        <div id="week_mileage_graph"></div>
        <div id="date_range_graph">
          <form action="/log/athlete/{{ user.id }}/" method='post'>
            {% csrf_token %}
            {{ form.errors }}
            {{ form }}
            <input type="submit" value="Show Mileage"/>
          </form>
        </div>
    </div>
    <div class="module_container">
      <h3>Workout History</h3>
        {% for r in all_runs %}
          <div>
          <a href="/log/athlete/activity_detail/{{ r.activity_id }}">
            <div class="run_detail btn">
              {{ r }} {{ r.activity.date }}
            </div>
          </a>
          <!-- <a href="/log/athlete/delete_activity/{{ r.activity_id }}">
            <div class='delete_run, btn'>DELETE</div>
          </a> -->
          <a href="/log/athlete/edit_activity/{{ r.activity_id }}">
            <div class='edit_run btn'>EDIT</div>
          </a>
          </div>
        {% endfor %}
    </div>
    <div class="module_container">
      <h3>Personal Records</h3>
      {% for pr in prs %}
        <div>
          <p>{{ pr.distance }} {{ pr.units }}:
          {{ pr.duration }}
          (at {{ pr.meet.location }} {{ pr.activity.date }})
          </p>
        </div>
      {% endfor %}
    </div>
  </div>
{% endblock %}
